# Genome Analysis Pipeline
This repository accompanies the MSc thesis **“Addressing Missing Heritability in Inherited Retinal Dystrophies: A Comprehensive, Phenotype-Driven Genome Analysis Pipeline for Novel Variant and Gene Discovery”** by Layla Ahmed (2025).

## 🧬 Project Overview

This project implements and validates a two-phase variant analysis pipeline combining:

- **Panel-Gene Analysis (PGA)** — phenotype-driven, targeted gene set analysis for known IRD genes.
- **Whole Genome Analysis (WGA)** — genome-wide discovery of variants (SNVs, indels, SVs) with a flexible scoring system integrating multiple in silico predictors.

This approach improves diagnostic yield by prioritizing non-coding and structural variants frequently missed by standard pipelines.

## 🧬 Files Overview

This repository contains **R Markdown (`.Rmd`)** files. R Markdown was chosen instead of standard `.R` scripts because it allows seamless integration of code, narrative text, and output, providing clear, reproducible workflows and an accessible record of analyses. This format supports transparency, better documentation, and easier sharing with collaborators.

> **Note:** `.Rmd` files are best run within **RStudio**, which provides an interactive environment for editing and rendering them. Although it is possible to render `.Rmd` files from the command line using `rmarkdown::render()`, they are not executable scripts in the same way `.R` files are. Users are welcome to adapt these workflows into `.R` scripts if they prefer a command-line interface.

## 📂 File Inputs

This pipeline accepts variant call files generated by **The Centre for Applied Genomics (TCAG)** at The Hospital for Sick Children (SickKids). Users may order next-generation sequencing (NGS) services directly from TCAG and run these files through the pipeline.  
Alternatively, users can process their own sequencing data but must ensure that input files match the expected column structure and nomenclature to prevent errors during downstream filtering. Always verify VCF or tabular format consistency before execution.

## ⚙️ Repository Contents

| File                               | Description                            |
| ---------------------------------- | -------------------------------------- |
| `WGA_SNV_hg38.Rmd`                 | Whole Genome SNV analysis (hg38)       |
| `WGA_SV_hg38.Rmd`                  | Whole Genome SV analysis (hg38)        |
| `PGA_SNV_hg38.Rmd`                 | Panel-Gene SNV analysis (hg38)         |
| `PGA_SV_hg38.Rmd`                  | Panel-Gene SV analysis (hg38)          |
| `InheritanceFilter.Rm`             | Inheritance Pattern (AR, AD) Filtering |

Each script processes variant call files and outputs prioritized candidate variants for interpretation.

## 🏷️ Key Features

✅ Integrated SNV, indel, and SV filtering  
✅ Flexible scoring using SIFT, PolyPhen2, REVEL, CADD, SpliceAI, and others  
✅ Customizable for AR and AD inheritance modes  
✅ Supports cross-variant merging for compound heterozygosity detection  
✅ Versions for GRCh37 (hg19) and GRCh38 (hg38) genome builds

## 🧑‍🔬 Intended Use

This pipeline is designed for research use in IRD gene discovery and diagnostic resolution of unsolved cases. Panel-gene lists should be tailored to each proband’s phenotype and clinical data.

## 📄 Requirements

- R (≥ 4.0)
- R packages: `tidyverse`, `data.table`, `vcfR`, `VariantAnnotation`, `GenomicRanges`, `plyr`, etc.
- High-quality GS data (VCF/BAM) with proper annotations

## 🚀 Getting Started

1. Clone the repository:
   ```bash
   git clone <YOUR_REPO_URL>
   ```
2. Edit `.Rmd` scripts to match your data paths and gene panels.
3. Run in RStudio or with `rmarkdown::render()`.
4. Review output files, merge SNV and SV results, and prioritize candidates.


## 🤝 Acknowledgements

Developed under the supervision of Dr. Ajoy Vincent & the Heon Lab, The Hospital for Sick Children, Toronto. Genome sequencing and bioinformatics: The Centre for Applied Genomics (TCAG).


Please cite this thesis if you use or adapt this pipeline:

> Ahmed L., *Addressing Missing Heritability in Inherited Retinal Dystrophies*, MSc Thesis, University of Toronto, 2025.

---

For questions or contributions, please feel free to get in touch.
